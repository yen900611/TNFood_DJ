{% extends 'food/base.html' %}
{% load static %}

{% block title %} 台南不需要米其林 {% endblock %}
{% block custom_style %}
  <link rel="stylesheet" href="{% static 'food/css/index.css' %}">
  <link rel="stylesheet" href="{% static 'food/css/carousel.css' %}">

{% endblock %}
{% block main %}
  <div class="container-fluid ">
    <div class="row place-gallery">
      <div class="col-12">
        <div id="recipeCarousel" class="carousel slide w-100" data-ride="carousel">
          <div class="carousel-inner w-100" role="listbox">
            <div class="carousel-item active">
              <div class="col-4">
                <div class="">
                  <img class="img-fluid" src="https://picsum.photos/240/240/?random=1">
                  <label></label>
                </div>
              </div>
            </div>
            <div class="carousel-item">
              <div class="col-4">
                <div class="">
                  <img class="img-fluid" src="https://picsum.photos/240/240/?random=2">
                  <label></label>
                </div>
              </div>
            </div>
            <div class="carousel-item">
              <div class="col-4">
                <div class="">
                  <img class="img-fluid" src="https://picsum.photos/240/240/?random=3">
                  <label></label>
                </div>
              </div>
            </div>
          </div>
          <a class="carousel-control-prev w-auto" href="#recipeCarousel" role="button" data-slide="prev">
                  <span class="carousel-control-prev-icon bg-dark border border-dark rounded-circle"
                        aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
          </a>
          <a class="carousel-control-next w-auto" href="#recipeCarousel" role="button" data-slide="next">
                  <span class="carousel-control-next-icon bg-dark border border-dark rounded-circle"
                        aria-hidden="true"></span>
            <span class="sr-only">Next</span>
          </a>

        </div>
      </div>
    </div>

    <div class="row">
      <form class="m-auto">
        <div class="form-row">
          <div class="col-3">
            <div><label for="">料理分類</label></div>
            <ul id="tag_filter">
            </ul>
          </div>
          <div class="col-3">
            <label for="">餐廳類型</label>
          </div>
          <div class="col-3">
          <label for="">餐廳類型</label>

          </div>
          <div class="col-3">

            <button class="btn btn-outline-success " type="submit">開始搜尋</button>
          </div>

        </div>
      </form>
    </div>
    <div class="row place-list" id="gallery">
    </div>
  </div>
{% endblock %}

{% block custom_script %}
  <script>


      let place_url = `${API_ENDPOINT}/places`
      fetch(place_url)
          .then(response => response.json())
          .then(result => {
              let gallery_ele = $('#gallery')
              console.table(result)

              result.forEach(place => {
                  gallery_ele.append(
                      `
              <div class="col col-lg-3 m-auto mb-1">
                    <div class="place-item">
                        <div>
                            <img src="${API_HOST}${place.photos[0].path}" alt="">
                        </div>
                        <div>
                    <a href="${API_HOST}/food/${place.id}">
                        <h5 class="align-content-center">${place.name}</h5></a>

                    </div>
              </div>
                    `
                  )

              });


          })
      let tags_url = `${API_ENDPOINT}/tags`
      fetch(tags_url).then(response => response.json())
          .then(tags => {
              let tagFilter = $('#tag_filter')

              tags.forEach(tag => {
                  tagFilter.append(
                      `
                      <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" name="food_style" value=${tag.value}}>
                            <label class="form-check-label" for="inlineCheckbox1">${tag.display}</label>
                          </div>
                          `
                  )

              });
              console.table(tags)

          })
      $('.carousel .carousel-item').each(function () {
          var minPerSlide = 3;
          var next = $(this).next();
          if (!next.length) {
              next = $(this).siblings(':first');
          }
          next.children(':first-child').clone().appendTo($(this));

          for (var i = 0; i < minPerSlide; i++) {
              next = next.next();
              if (!next.length) {
                  next = $(this).siblings(':first');
              }

              next.children(':first-child').clone().appendTo($(this));
          }
      });
  </script>
{% endblock %}