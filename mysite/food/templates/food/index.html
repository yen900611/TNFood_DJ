{% extends 'food/base.html' %}
{% load static %}

{% block title %} 台南不需要米其林 {% endblock %}
{% block custom_style %}
  <link rel="stylesheet" href="{% static 'food/css/index.css' %}">

{% endblock %}
{% block main %}
  <div class="container-fluid ">
    <div class="row place-gallery">
      <!-- TODO Edit here -->
      <p>熱門分類</p>

    </div>
    <form action="/food" method="get">
      <div class="row place-filter">
        <div class="col-9">

          <div><label for="">料理分類</label></div>
          <ul id="tag_filter">
          </ul>
          <br>


        </div>
        <div class="col-3">
          <button class="btn btn-outline-success " type="submit">開始搜尋</button>
        </div>

      </div>
    </form>
    <div class="row place-list" id="gallery">
    </div>
  </div>
  {#  <div class="container-fluid border-bottom">#}
  {#    <div class="row ">#}
  {#      <div class="col-3 border-right template-sidebar m-1">#}
  {#        {% include 'food/form_filter.html' with tags=tags %}#}
  {#        <h4>今天想吃什麼呢？</h4>#}
  {#        <form action="/food" method="get">#}
  {#          <div><label for="">料理分類</label></div>#}
  {#          <ul id="tag_filter">#}
  {#          </ul>#}
  {#          <br>#}
  {#          <button class="btn btn-outline-success" type="submit">開始搜尋</button>#}
  {#        </form>#}
  {#      </div>#}
  {#      <div class="col-8">#}
  {#        <div class="container-fluid">#}
  {#          <div class="row " >#}
  {#          </div>#}
  {#        </div>#}
  {#      </div>#}
  {#    </div>#}
  {#  </div>#}
{% endblock %}

{% block custom_script %}
  <script>


      let place_url = `${API_ENDPOINT}/places`
      fetch(place_url)
          .then(response => response.json())
          .then(result => {
              let gallery_ele = $('#gallery')
              console.table(result)

              result.forEach(place => {
                  gallery_ele.append(
                      `
              <div class="col col-lg-3 m-auto">
                    <div class="place-item">
                        <div>
                            <img src="${API_HOST}${place.photos[0].path}" alt="">
                        </div>
                        <div>
                    <a href="${API_HOST}/food/${place.id}">
                        <h5 class="align-content-center">${place.name}</h5></a>

                    </div>
              </div>
                    `
                  )

              });


          })
      let tags_url = `${API_ENDPOINT}/tags`
      fetch(tags_url).then(response => response.json())
          .then(tags => {
              let tagFilter = $('#tag_filter')

              tags.forEach(tag => {
                  tagFilter.append(
                      `
                      <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" name="food_style" value=${tag.value}}>
                            <label class="form-check-label" for="inlineCheckbox1">${tag.display}</label>
                          </div>
                          `
                  )

              });
              console.table(tags)

          })
  </script>
{% endblock %}